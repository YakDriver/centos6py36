language: python
sudo: required

before_install:
  - sudo service docker stop
  - sleep 10
  - sudo apt-get remove docker docker-engine docker.io
  - sudo apt-get update        # Fetches the list of available updates
  - |
    sudo apt-get install \
      apt-transport-https \
      ca-certificates \
      curl \
      software-properties-common \
      docker-ce
  - sudo service docker restart
  - sudo docker --version
  - sleep 5

install:
  - sudo docker pull centos:centos6

script:
  - sudo docker build -t ${DOCKER_USERNAME}/${DOCKER_REPO} .

  # Deploy in script since docker isn't a provider
  - sudo docker login --username=${DOCKER_USERNAME} --password=${DOCKER_PASSWORD}
  - sudo docker push ${DOCKER_USERNAME}/${DOCKER_REPO}